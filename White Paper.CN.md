# 软件系统白皮书

## 1. 引言

随着软件开发和开放源代码的普及，安全性和合规性成为了企业和开发者日益关注的重点。本系统旨在通过自动化解析源代码、二进制组件以及固件，提供详尽的软件成分分析，确保安全风险的识别与管理，以提升软件产品的安全性。

## 2. 系统概述

本软件系统采用先进的解析和分析技术，主要功能包括：

- **软件成分分析**：自动解析输入的源代码、二进制软件包和固件，生成开源软件清单及公开的漏洞清单。
- **风险检测**：运用多种检测技术，识别软件中的信息泄露、弱密码、错误配置等风险。
- **深度计算与虚拟运行分析**：通过深度计算和模拟运行环境，发现二进制软件中的尚未公开的安全风险，如空指针、堆栈溢出和重复释放等。

## 3. 功能详细介绍

### 3.1 软件成分分析

系统能够自动解析源代码和二进制文件，提取以下信息：

- **开源组件清单**：识别并列出所有使用的开源软件组件及其许可证信息。
- **公开漏洞信息**：基于当前通用漏洞披露数据库（如CVE数据库），提供已知漏洞的清单及其相关信息，包括风险等级和修复建议。

### 3.2 风险检测

通过多种技术手段，系统可检测并报告多种类型的潜在风险：

- **信息泄露**：识别代码中可能泄露敏感信息的部分。
- **弱密码**：检测应用中可能使用的弱密码或加密机制。
- **错误配置**：分析软件配置文件，识别安全配置问题，并提供改进建议。

### 3.3 深度计算与虚拟运行

为识别尚未公开的安全风险，本系统采用先进技术进行深入分析：

- **动态分析**：在隔离环境中运行应用，监测其行为，捕捉异常。
- **静态分析**：对源代码和二进制进行静态检查，识别潜在的代码缺陷和逻辑错误。
- **漏洞探索**：利用模糊测试等技术，发现潜在的安全漏洞。

## 4. 系统架构

本软件系统采用模块化设计，主要包括以下组件：

- **解析模块**：负责对源代码和二进制文件的解析。
- **分析模块**：进行代码成分分析和风险检测。
- **报告生成模块**：生成详细的分析报告，提供可视化结果。
- **数据库模块**：存储已知漏洞及开源组件的信息。

## 5. 安全与合规性

在设计与开发过程中，系统遵循安全最佳实践，确保：

- **数据隐私**：严格控制数据访问权限，遵循GDPR等数据保护法规。
- **合规性审查**：系统确保开源软件的合规使用，并提供所需的文档支持。

## 6. 支持的文件格式

本系统支持以下文件格式的解压缩和分析：

- **图像格式**:
  
  - WebP
  - BMP（需要PIL）
  - PNG/APNG（需要PIL）
  - GIF（需要PIL）
  - ICO（MS Windows图标）
  - SGI图像文件（需要PIL）
  - JPG/JPEG（需要PIL）
  - Sun Raster files（标准类型）

- **音频格式**:
  
  - WAV
  - AIFF/AIFF-C
  - AU（Sun/NeXT音频）
  - FLV（Macromedia Flash视频）
  - MIDI
  - Ogg

- **压缩格式**:
  
  - Gzip
  - Bzip2
  - LZMA
  - XZ
  - Lzip
  - LZ4（需要LZ4 Python绑定）
  - Zstd（需要zstd包）
  - RZIP（需要rzip）
  - LZOP
  - 7z（需要外部工具）

- **归档格式**:
  
  - ZIP（存储、解压、bzip2，但LZMA需要更多测试），包括JAR、APK和其他ZIP基础格式（无效中央目录的悬挂条目）
  - tar
  - CPIO（各种风格，小端）
  - RPM（gzip，XZ，bzip2，LZMA，zstd，不支持：delta RPM）
  - XAR（无压缩，gzip，bzip2，XZ，LZMA）

- **系统和固件格式**:
  
  - ISO9660（包括RockRidge和zisofs）
  - U-Boot镜像
  - Android稀疏数据图像（常规和Brotli压缩，无bsdiff/imgdiff）
  - Android备份文件
  - Android资源文件（二进制XML，表格类型）
  - Android引导加载程序镜像

- **文档格式**:
  
  - PDF（简单验证，不支持对象流，增量更新在文件末尾）
  - XML（整个文件）
  - JSON（整个文件）
  - GNU消息目录
  - iCalendar（RFC 5545，整个文件）

- **代码和文件格式**:
  
  - Java类文件
  - Android Dex/Odex（不支持OAT，仅雕刻）
  - ELF
  - SWF（未压缩，zlib，LZMA）
  - Python PKG-INFO文件（整个文件）
  - Dockerfile文件（整个文件）
  - NibArchive

- **特殊格式**:
  
  - Chrome PAK（版本4和5，仅在偏移量从0开始时）
  - Git索引文件
  - Snap framing2格式（需要python-snappy）
  - SELinux文件上下文
  - Performance Co-Pilot元数据文件
  - DHTB签名文件
  - Ubuntu和Debian包（需要binutils）
  - 硬件特定固件，例如Reolink、Granite Devices、Huawei固件等

#### 整体支持的特性

支持的格式不仅限于基本的识别，还包括对某些文件结构的基本检查和部分功能，如数据提取、解析和验证。确保为每个文件格式提供了适当的支持工具和库，并注意某些格式可能需要额外的依赖或有支持限制。

## 7. 支持的被检测文件类型

本系统支持以下文件类型：

#### 可执行文件

- **Windows**
  
  - 动态链接库：`.dll`
  - Windows可执行文件：`.exe`
  - Windows安装包：`.msi`

- **Linux**
  
  - 可执行文件：ELF格式（无特定后缀）

#### 库文件

- **动态链接库**
  
  - Linux共享对象文件：`.so`

- **静态链接文件**
  
  - 静态库文件：`.a`
  - 目标文件：`.obj`

#### Java文件

- Java程序包：`.jar`
- Java字节码文件：`.class`

#### 源代码文件

- C/C++语言源代码文件：如`.c`、`.cpp`、`.h`等
- Java语言源代码文件：如`.java`
- Go源代码文件：如`.go`
- Rust源代码文件：如`.rs`
- Python源代码文件：如`.py`
- Perl源代码文件：如`.pl`

## 8. 支持的公开漏洞库

本系统基于公开漏洞库，提供已知漏洞的清单及其相关信息，包括风险等级和修复建议。目前，系统支持以下公开漏洞库：

以下是支持的四种漏洞库的概述：

1. **CVE (Common Vulnerabilities and Exposures)**
   
   - CVE 是一个国际公开的漏洞数据库，由美国国家安全局（NSA）和其他组织共同维护。它为每一个已知的安全漏洞分配一个唯一的标识号码（CVE ID），以便于跨多个安全产品和服务的共享和通报。

2. **CNNVD (China National Vulnerability Database)**
   
   - CNNVD 是由中国国家互联网应急中心（CNCERT）维护的漏洞数据库，主要记录和管理中国境内外的网络安全漏洞信息，提供相应的检测和修复建议。

3. **CNVD (China National Vulnerability Database)**
   
   - CNVD 是中国国家信息安全漏洞库，由中国国家网络与信息安全信息中心（CNIS）运营，作为国家信息安全漏洞信息的集中管理平台，提供丰富的漏洞信息和修复指导。

4. **JVN (Japan Vulnerability Notes)**
   
   - JVN 是由日本的内阁网络安全中心（NCSC）维护的漏洞信息库，提供关于软件漏洞的通告和相关信息，特别是针对日本市场的安全软件和系统的信息。

5. **Exploit-DB**

   - Exploit-DB 是一个公开的漏洞利用代码数据库，收录了大量的漏洞利用代码和安全工具。该平台为安全研究人员和渗透测试人员提供了一个资源库，使他们能寻找特定漏洞的已知利用方法。用户可以通过 Exploit-DB 查询特定的 CVE ID，获取与之相关的漏洞利用信息，从而加深对漏洞影响的理解及其潜在风险。

通过整合上述漏洞数据库和 Exploit-DB 的支持，用户能够全面获取关于已知漏洞及其利用方式的信息。这种整合有助于在漏洞评估和修复过程中，快速有效地识别与被测软件和环境相关的安全风险，做出更为准确的决策。在静态检测和漏洞管理中，结合多源漏洞信息将极大地增强系统的安全防护能力。

## 9. 漏洞识别过滤功能（Context Filtering）

本系统提供的漏洞识别过滤功能（Context Filtering）是一个静态检测工具，旨在帮助用户根据被测软件的类型更有效地识别和筛选相关漏洞。该功能针对操作系统和源代码解包提供了灵活的过滤选项，以提高漏洞分析的精准度。

#### 1. 操作系统过滤

- **针对特定操作系统的漏洞筛选**：
  
  - 用户可以选择其软件运行的操作系统（如 Windows、Linux、macOS 等），系统将仅提供与所选操作系统相关的漏洞信息。在分析时，过滤掉与其他操作系统无关的漏洞数据，从而减少信息噪声。

- **版本匹配支持**：
  
  - 用户还可以指定特定的操作系统版本，以确保获取的漏洞信息与其实际环境相匹配，增强了识别的准确性。

#### 2. 源代码解包过滤

- **源代码分析能力**：
  
  - 对于使用开源或自定义代码的软件，用户可以进行源代码解包。系统将对解包后获得的源代码进行静态分析，识别出与之相关的已知漏洞。

- **依赖库筛选**：
  
  - 用户可以筛选特定的依赖库，检查与所使用的特定库相关的漏洞。这有助于开发人员高效地定位需要修复的安全问题。

#### 3. 静态检测结果输出

- **汇总报告**：
  - 系统将静态检测的结果以报告形式输出，包括筛选后的漏洞信息和对应的风险评估。这些报告可供用户参考，帮助其制定相应的安全措施。

## 10. 漏洞库更新

本系统提供多种方式，帮助用户维护和更新已知的漏洞库，以确保信息的准确性和及时性，从而有效管理安全风险。

#### 便捷更新

- **原厂提供的更新包**：
  - 系统支持通过直接安装由官方提供的更新 Debian（deb）包来实现漏洞库的快速更新。用户只需简单下载和安装更新包，即可自动获取最新的漏洞信息和修复建议，而无需进行复杂的配置或设置。

#### 自主更新

- **自定义更新功能**：
  
  - 本系统允许用户根据自身需求，自主配置和更新漏洞库。用户可以指定更新的频率、源以及特定的漏洞信息，确保覆盖所有重要的安全威胁。

- **灵活的更新选项**：
  
  - 用户可以选择从各个公开漏洞数据库（如 CVE、CNNVD、CNVD、JVN）中获取最新的信息，并进行合并和整合。同时，用户也可以手动添加特定的漏洞信息，以增强系统的适应性和响应能力。

## 11. 支持的信息泄露类型

1. **URL（网址）**
   
   - 检测特性：检查网址是否为恶意域名，分析域名信誉，提供安全评级。

2. **IP地址**
   
   - 检测特性：根据IP地址提供其归属信息，检测是否为黑名单IP，并提供地理位置相关信息。

3. **Email（电子邮件）**
   
   - 检测特性：检查电子邮件地址的有效性，识别是否为已知的恶意邮箱，进行风险评级。

4. **File Path（文件路径）**
   
   - 检测特性：分析文件路径的安全性，检测是否泄露敏感目录或文件。

5. **CID（身份证号码）**
   
   - 检测特性：验证CID格式，并提供身份证号码的详细信息，包括性别、出生日期、地址、签发机关等。

6. **Phone（电话号码）**
   
   - 检测特性：提供电话号码的详细信息，包括归属地、运营商、状态（是否有效或已停用）。

7. **GPS地址（地理位置）**
   
   - 检测特性：解析GPS坐标信息并提供对应的地理位置说明，包括街道名称、城市等相关信息。

## 12. 未知漏洞(C/C++)覆盖的常见风险类型

- **copy_to_static** 
  
  - 风险描述：将动态分配的内存数据复制到静态内存区域，可能导致非预期的行为。
  - 对应CWE：`CWE-457`（使用不安全的静态存储）

- **deadlock**
  
  - 风险描述：多个线程在等待对方释放资源，导致程序无法继续执行。
  - 对应CWE：`CWE-833`（死锁）

- **double_free**
  
  - 风险描述：尝试释放已被释放的内存，可能导致程序崩溃或安全漏洞。
  - 对应CWE：`CWE-415`（双重释放）

- **forbidden_function**
  
  - 风险描述：使用不安全或不被推荐的函数，可能引发安全漏洞。
  - 对应CWE：`CWE-676`（使用已禁止的函数）

- **free_non_heap**
  
  - 风险描述：尝试释放非堆内存，可能导致未定义行为。
  - 对应CWE：`CWE-590`（尝试释放非堆内存）

- **infinite_loop**
  
  - 风险描述：程序进入无限循环状态，导致资源耗尽或性能下降。
  - 对应CWE：`CWE-835`（无限循环）

- **input_analysis**
  
  - 风险描述：对输入数据分析不足，可能导致安全漏洞或程序崩溃。
  - 对应CWE：`CWE-20`（输入数据验证不足）

- **invalid_argument**
  
  - 风险描述：向函数传递无效参数，可能导致程序崩溃或未定义行为。
  - 对应CWE：`CWE-687`, `CWE-688`, `CWE-689`（无效参数传递）

- **invalid_buffer**
  
  - 风险描述：使用无效或不正确大小的缓冲区，可能导致数据损坏或安全漏洞。
  - 对应CWE：`CWE-119`, `CWE-120`, `CWE-121`, `CWE-122`（缓冲区错误）

- **invalid_string**
  
  - 风险描述：使用无效字符串，可能导致安全漏洞或程序崩溃。
  - 对应CWE：`CWE-170`（不正确的字符串比较）

- **null_dereference**
  
  - 风险描述：尝试访问空指针，导致程序崩溃。
  - 对应CWE：`CWE-476`（空指针解引用）

- **random_access**
  
  - 风险描述：对数据结构的随机访问，可能导致未定义行为或数据损坏。
  - 对应CWE：`CWE-338`（不安全的随机访问）

- **return_of_stack**
  
  - 风险描述：返回函数时栈空间未正确释放，可能导致内存泄漏或其他问题。
  - 对应CWE：`CWE-416`（栈返回）

- **scan_format**
  
  - 风险描述：处理格式化字符串时不当，可能导致缓冲区溢出或其他漏洞。
  - 对应CWE：`CWE-134`, `CWE-135`（格式化字符串错误）

- **signed_unsigned**
  
  - 风险描述：处理有符号与无符号数据时的混淆，可能导致比较错误或溢出。
  - 对应CWE：`CWE-195`, `CWE-196`, `CWE-197`（有符号与无符号比较错误）

- **unsigned_overflow**
  
  - 风险描述：无符号整数溢出，可能导致数据损坏或未定义行为。
  - 对应CWE：`CWE-190`（无符号整数溢出）

- **toc_tou**
  
  - 风险描述：时间和条件竞争漏洞，可能导致不当访问或修改。
  - 对应CWE：`CWE-367`（时间和竞争条件漏洞）

- **unchecked_return_value**
  
  - 风险描述：未检查函数返回值，可能导致安全漏洞或程序错误。
  - 对应CWE：`CWE-252`, `CWE-253`（未检查返回值）

- **use_after_free**
  
  - 风险描述：在内存已被释放后仍尝试使用，可能导致安全漏洞。
  - 对应CWE：`CWE-416`（使用释放后的内存）

- **wrong_size_memset**
  
  - 风险描述：对内存的设置使用错误大小，可能导致数据溢出或程序崩溃。
  - 对应CWE：`CWE-131`（错误的内存设置大小）

## 13.  用户定制功能

- **自定义检测规则**：
  
  - **信息泄露检测**：
    
    - 用户可以创建特定的规则来检测敏感信息的泄露（如个人识别信息、财务数据、密码等）。
    - 允许用户指定关键字、数据模式或特定路径，以便在发现异常时触发告警。
  
  - **恶意软件检测**：
    
    - 用户能够自定义恶意软件检测规则，包括设置可疑文件类型、特征签名或异常行为模式。
    - 提供选项让用户决定监测范围，例如全域或特定目录下的文件。
  
  - **错误配置检测**：
    
    - 用户可以定义具体的配置基准，确保系统和应用符合最佳安全实践。
    - 允许用户指定不安全的配置选项（如默认密码、开放端口等），并对其进行检测。
  
  - **弱密码检测**：
    
    - 用户可以启用弱密码检测功能，识别不符合安全标准的密码。
    - 允许用户上传自定义密码爆破库，这些库包含常见的弱密码，系统将根据这些库进行比对。
    - 用户可以设置密码生成规则，包括密码长度、字符类型（如大小写字母、数字、特殊字符）等，确保生成的密码满足安全要求。

- **灵活性和适应性**：
  
  - 用户可以根据行业要求、合规性标准或具体业务需求灵活调整检测规则，从而提高检测的准确性和有效性。
  - 提供直观的用户界面，使用户能够快速添加、修改或删除检测规则。

- **规则优先级与响应机制**：
  
  - 用户可以为每个规则设置优先级，以便在发现多项威胁时能够合理安排响应顺序。
  - 允许用户配置自动响应动作，比如封锁某些行为、触发报警通知或生成报告。

- **用户友好的管理和监控**：
  
  - 提供便于操作的管理平台，用户可以实时监控检测规则的运行状态和效果。
  - 允许用户查看规则的历史记录和执行日志，以便进行审计和分析。

## 14. 特征库与工具链

- **友好的特征库管理**：
  
  - 提供一个用户友好的界面，方便用户管理特征库，包括查看现有组件、添加新组件和删除不再需要的组件。
  - 支持对特征库中的组件进行分类和标签管理，以便于快速查找和使用。

- **工具链支持**：
  
  - 提供完整的工具链，帮助用户自动化爬取所需的开源组件，轻松获取和整合来自多个源的特征信息。
  - 用户可以通过工具链简单配置，迅速开始爬取特定领域的开源项目和组件。

- **组件添加与自定义**：
  
  - 允许用户自行使用工具链添加新的开源组件，支持通过输入组件名称和版本信息来快速引入。
  - 提供灵活的接口，以便用户根据需求扩展特征库，支持从多种数据源导入组件信息。

- **生成特征库**：
  
  - 支持根据用户上传的二进制文件生成特征库，自动并且快速提取有用的特征信息。
  - 同时支持从源代码生成特征库，用户可以上传代码文件，系统将分析代码并提取相应的特征。

- **快速语言支持扩展**：
  
  - 提供简单的步骤让用户能够快速添加对新的编程语言的支持，扩展特征库的功能。
  - 通过配置语言解析器和特征提取规则，用户可以轻松支持新语言的安全检测。

- **特征库的更新与维护**：
  
  - 用户能够定期更新特征库，确保及时引入最新的开源组件和漏洞信息。
  - 提供自动更新功能，用户可以选择定期检查并自动同步最新的特征库数据。

## 15. 容器化部署要求

本系统支持容器化部署，适用于各种提供 Docker Compose 环境的 Linux 系统。用户在 Windows 系统上可选择先部署 Linux 虚拟机，以满足容器化要求。以下是具体的部署要求和建议：

#### 1. 支持的操作系统

- **Linux 系统**：
  - 支持所有主流的 Linux 发行版，如 Ubuntu、CentOS、Debian 等，前提是它们能运行 Docker 和 Docker Compose。
- **Windows 系统**：
  - Windows 用户建议通过虚拟机（如 VMware、VirtualBox 等）部署 Linux 系统，确保其能够使用 Docker 环境。

#### 2. 部署方式

- **单机部署**：
  - 适用于小规模测试和开发，可以在单台机器上运行Docker Compose。
- **集群部署**：
  - 支持在多台机器上分布式部署，以提高系统的可用性和扩展性。

#### 3. 系统资源要求

- **商业部署建议配置**：
  - **内存**：64GB 以上
  - **CPU**：8 核心以上
  - **存储**：1TB 固态硬盘或更高
- **测试部署最低配置**：
  - **内存**：16GB
  - **CPU**：建议至少 4 核心
  - **存储**：足够的空间以容纳容器和数据

### 其他注意事项

- 在进行容器化部署时，确保 Docker 和 Docker Compose 的最新版本已安装，以获得最佳性能和功能支持。
- 考虑使用 Docker Volume 和网络配置，以保证数据持久性和容器间的高效通信。

通过以上要求和建议，用户可以选择合适的部署方式和环境，以满足其具体的业务需求。

## 16. 结论

本软件系统的目标是提升软件的安全性和合规性，通过全面的分析与检测技术，为用户提供有效的风险识别和管理解决方案。我们相信，借助此系统，开发团队将能够更好地把控软件安全，助力企业在数字化转型过程中迈向更高的安全标准。

## 17. 联系我们

如需进一步了解本系统的功能或使用，请通过以下方式联系我们：

- **电子邮箱**：
  - <EMAIL>support@chime-lab.cn
  - <EMAIL>sales@chime-lab.cn


